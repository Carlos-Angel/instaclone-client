(this["webpackJsonpinstaclone-client"]=this["webpackJsonpinstaclone-client"]||[]).push([[0],{282:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},294:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},298:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){},302:function(e,t,n){},303:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},308:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){},314:function(e,t,n){},315:function(e,t,n){},316:function(e,t,n){},319:function(e,t,n){},320:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n(58),s=n.n(c),i=n(14),u=n(10),o=n(23),l=n(45),b=n(336),j=n.n(b),d=n(251),m="token",O=n(244);function h(e){localStorage.setItem(m,e)}function p(){return localStorage.getItem(m)}function f(e){return Object(O.a)(e)}var v=j()({uri:"https://carlos-instaclone-server.herokuapp.com/"}),x=Object(d.a)((function(e,t){var n=t.headers,a=p();return{headers:Object(l.a)(Object(l.a)({},n),{},{Authorization:a?"Bearer ".concat(a):""})}})),g=new u.ApolloClient({connectToDevTools:!0,cache:new u.InMemoryCache,link:x.concat(v)}),w=n(340),C=n(252),S=n(19),N=n.n(S),y=n(33),P=n(342),k=n(322),q=n(53),$=n(24),F=n(30);function I(){var e=Object(F.a)(["\n  query search($search: String) {\n    search(search: $search) {\n      name\n      username\n      avatar\n    }\n  }\n"]);return I=function(){return e},e}function U(){var e=Object(F.a)(["\n  mutation updateUser($input: UserUpdateInput) {\n    updateUser(input: $input)\n  }\n"]);return U=function(){return e},e}function M(){var e=Object(F.a)(["\n  mutation deleteAvatar {\n    deleteAvatar\n  }\n"]);return M=function(){return e},e}function _(){var e=Object(F.a)(["\n  mutation updateAvatar($file: Upload) {\n    updateAvatar(file: $file) {\n      status\n      urlAvatar\n    }\n  }\n"]);return _=function(){return e},e}function E(){var e=Object(F.a)(["\n  query getUser($id: ID, $username: String) {\n    getUser(id: $id, username: $username) {\n      id\n      name\n      username\n      email\n      siteWeb\n      description\n      avatar\n    }\n  }\n"]);return E=function(){return e},e}function z(){var e=Object(F.a)(["\n  mutation login($input: LoginInput) {\n    login(input: $input) {\n      token\n    }\n  }\n"]);return z=function(){return e},e}function L(){var e=Object(F.a)(["\n  mutation register($input: UserInput) {\n    register(input: $input) {\n      id\n      name\n      email\n      createdAt\n    }\n  }\n"]);return L=function(){return e},e}var A=Object(u.gql)(L()),Q=Object(u.gql)(z()),W=Object(u.gql)(E()),D=Object(u.gql)(_()),R=Object(u.gql)(M()),T=Object(u.gql)(U()),V=Object(u.gql)(I());n(282);function B(e){var t=e.setShowLogin,n=Object(u.useMutation)(A),r=Object(i.a)(n,1)[0],c=Object(q.a)({initialValues:{name:"",email:"",username:"",password:"",repeatPassword:""},validationSchema:$.a({name:$.c().required("Tu nombre es obligatorio"),email:$.c().email("El email no es valido").required("El email es obligatorio"),username:$.c().matches(/^[a-zA-Z0-9-]*$/,"El nombre del usuario no debe tener espacios").required("El nombre del usuario es obligatorio"),password:$.c().required("La contrase\xf1a es obligatoria"),repeatPassword:$.c().required("La contrase\xf1a es obligatoria").oneOf([$.b("password")],"Las contrase\xf1as no coinciden entre si")}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,delete(a=n).repeatPassword,e.next=5,r({variables:{input:a}});case 5:o.b.success("USuario registrado correctamente"),t(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),o.b.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"register-form-title",children:"Reg\xedstrate para ver fotos y videos de tus amigos"}),Object(a.jsxs)(P.a,{className:"register-form",onSubmit:c.handleSubmit,children:[Object(a.jsx)(P.a.Input,{type:"text",placeholder:"Nombre y apellidos",name:"name",value:c.values.name,onChange:c.handleChange,error:c.errors.name&&!0}),Object(a.jsx)(P.a.Input,{type:"text",placeholder:"Correo electr\xf3nico",name:"email",value:c.values.email,onChange:c.handleChange,error:c.errors.email&&!0}),Object(a.jsx)(P.a.Input,{type:"text",placeholder:"Nombre de usuario",name:"username",value:c.values.username,onChange:c.handleChange,error:c.errors.username&&!0}),Object(a.jsx)(P.a.Input,{type:"password",placeholder:"Contrase\xf1a",name:"password",value:c.values.password,onChange:c.handleChange,error:c.errors.password&&!0}),Object(a.jsx)(P.a.Input,{type:"password",placeholder:"Confirmar contrase\xf1a",name:"repeatPassword",value:c.values.repeatPassword,onChange:c.handleChange,error:c.errors.repeatPassword&&!0}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Registrate"})]})]})}var H=Object(r.createContext)({user:void 0}),J=function(){return Object(r.useContext)(H)};n(287);function K(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(u.useMutation)(Q),o=Object(i.a)(s,1)[0],l=J().setUser,b=Object(q.a)({initialValues:{email:"",password:""},validationSchema:$.a({email:$.c().email("El correo electr\xf3nico no es valido").required("El correo electr\xf3nico es obligatorio"),password:$.c().required("La contrase\xf1a es obligatorio")}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(t){var n,a,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(""),e.prev=1,e.next=4,o({variables:{input:t}});case 4:n=e.sent,a=n.data,h(r=a.login.token),l(f(r)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),c(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:"Entra para ver fotos y videos de tus amigos"}),Object(a.jsxs)(P.a,{className:"login-form",onSubmit:b.handleSubmit,children:[Object(a.jsx)(P.a.Input,{type:"text",placeholder:"correo electr\xf3nico",name:"email",value:b.values.email,onChange:b.handleChange,error:b.errors.email&&!0}),Object(a.jsx)(P.a.Input,{type:"password",placeholder:"Contrase\xf1a",name:"password",value:b.values.password,onChange:b.handleChange,error:b.errors.password&&!0}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Iniciar sessi\xf3n"}),n&&Object(a.jsxs)("p",{className:"submit-error",children:[" ",n," "]})]})]})}var Z=n.p+"static/media/instaclone.6489b803.png";n(288);function G(){var e=Object(r.useState)(!0),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(a.jsxs)(w.a,{fluid:!0,className:"auth",children:[Object(a.jsx)(C.a,{src:Z}),Object(a.jsx)("div",{className:"container-form",children:n?Object(a.jsx)(K,{}):Object(a.jsx)(B,{setShowLogin:c})}),Object(a.jsx)("div",{className:"change-form",children:Object(a.jsx)("p",{children:n?Object(a.jsxs)(a.Fragment,{children:["\xbfNo tienes una cuenta?",Object(a.jsx)("span",{onClick:function(){return c(!n)},children:"Reg\xedstrate"})]}):Object(a.jsxs)(a.Fragment,{children:["\xa1Entra con tu cuenta!",Object(a.jsx)("span",{onClick:function(){return c(!n)},children:"Iniciar sesi\xf3n"})]})})})]})}var X=n(37),Y=n(347),ee=n(198);n(289);function te(e){var t=e.setShowModal,n=e.auth,c=Object(r.useState)(!1),s=Object(i.a)(c,2),b=s[0],j=s[1],d=Object(u.useMutation)(D,{update:function(e,t){var a=t.data.updateAvatar,r=e.readQuery({query:W,variables:{username:n.username}}).getUser;e.writeQuery({query:W,variables:{username:n.username},data:{getUser:Object(l.a)(Object(l.a)({},r),{},{avatar:a.urlAvatar})}})}}),m=Object(i.a)(d,1)[0],O=Object(u.useMutation)(R,{update:function(e){var t=e.readQuery({query:W,variables:{username:n.username}}).getUser;e.writeQuery({query:W,variables:{username:n.username},data:{getUser:Object(l.a)(Object(l.a)({},t),{},{avatar:""})}})}}),h=Object(i.a)(O,1)[0],p=Object(r.useCallback)(function(){var e=Object(y.a)(N.a.mark((function e(n){var a,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n[0],e.prev=1,j(!0),e.next=5,m({variables:{file:a}});case 5:r=e.sent,r.data.updateAvatar.status?t(!1):o.b.warning("Error al actualizar el avatar"),j(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),o.b.warning("Error al actualizar el avatar");case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),[]),f=Object(ee.a)({accept:"image/jpeg, image/jpg, image/png",noKeyboard:!0,multiple:!1,onDrop:p}),v=f.getRootProps,x=f.getInputProps,g=function(){var e=Object(y.a)(N.a.mark((function e(){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h();case 3:n=e.sent,n.data.deleteAvatar?t(!1):o.b.warning("error al borrar el avatar"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o.b.warning("error al borrar el avatar");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"avatar-form",children:[Object(a.jsx)(k.a,Object(l.a)(Object(l.a)({},v()),{},{loading:b,children:"Subir Foto de perfil"})),Object(a.jsx)(k.a,{onClick:g,children:"Eliminar Foto perfil"}),Object(a.jsx)(k.a,{onClick:function(){return t(!1)},children:"Cancelar"}),Object(a.jsx)("input",Object(l.a)({},x()))]})}var ne=n(40);n(290);function ae(){return Object(a.jsxs)("div",{className:"user-not-found",children:[Object(a.jsx)("p",{children:"Usuario no encontrado"}),Object(a.jsx)("p",{children:"Es posible que el enlace que has seguido sea incorrecto o el usuario se haya eliminado"}),Object(a.jsx)(ne.b,{to:"/",children:"Volver al Home"})]})}var re=n(344);n(292);function ce(e){var t=e.show,n=e.setShow,r=e.title,c=e.children;return Object(a.jsxs)(re.a,{size:"mini",open:t,onClose:function(){return n(!1)},className:"modal-basic",children:[r&&Object(a.jsx)(re.a.Header,{children:r}),c]})}var se=n.p+"static/media/avatar.235f193d.png";function ie(){var e=Object(F.a)(["\n  query getNotFolloweds {\n    getNotFolloweds {\n      username\n      name\n      avatar\n    }\n  }\n"]);return ie=function(){return e},e}function ue(){var e=Object(F.a)(["\n  query getFolloweds($username: String!) {\n    getFolloweds(username: $username) {\n      username\n      name\n      avatar\n    }\n  }\n"]);return ue=function(){return e},e}function oe(){var e=Object(F.a)(["\n  query getFollowers($username: String!) {\n    getFollowers(username: $username) {\n      username\n      name\n      avatar\n    }\n  }\n"]);return oe=function(){return e},e}function le(){var e=Object(F.a)(["\n  mutation unFollow($username: String!) {\n    unFollow(username: $username)\n  }\n"]);return le=function(){return e},e}function be(){var e=Object(F.a)(["\n  mutation follow($username: String!) {\n    follow(username: $username)\n  }\n"]);return be=function(){return e},e}function je(){var e=Object(F.a)(["\n  query isFollow($username: String!) {\n    isFollow(username: $username)\n  }\n"]);return je=function(){return e},e}var de=Object(u.gql)(je()),me=Object(u.gql)(be()),Oe=Object(u.gql)(le()),he=Object(u.gql)(oe()),pe=Object(u.gql)(ue()),fe=Object(u.gql)(ie());n(293);function ve(e){var t=e.username,n=e.auth,r=e.handleModal,c=Object(u.useMutation)(me),s=Object(i.a)(c,1)[0],l=Object(u.useMutation)(Oe),b=Object(i.a)(l,1)[0],j=Object(u.useQuery)(de,{variables:{username:t}}),d=j.data,m=j.loading,O=j.refetch,h=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{username:t}});case 3:O(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o.b.error(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b({variables:{username:t}});case 3:O(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o.b.error(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"header-profile",children:[Object(a.jsx)("h2",{children:t}),t===n.username?Object(a.jsx)(k.a,{onClick:function(){r("settings")},children:"Ajustes"}):!m&&(d.isFollow?Object(a.jsx)(k.a,{className:"btn-danger",onClick:p,children:"Dejar de seguir"}):Object(a.jsx)(k.a,{className:"btn-action",onClick:h,children:"Seguir"}))]})}n(294);function xe(e){var t=e.onLogout,n=Object(u.useMutation)(T),c=Object(i.a)(n,1)[0],s=Object(r.useState)(""),l=Object(i.a)(s,2),b=l[0],j=l[1],d=Object(q.a)({initialValues:{currentPassword:"",newPassword:"",repeatNewPassword:""},validationSchema:$.a({currentPassword:$.c().required(),newPassword:$.c().required(),repeatNewPassword:$.c().required().oneOf([$.b("newPassword")],"Las contrase\xf1as no coinciden entre si")}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(""),e.prev=1,e.next=4,c({variables:{input:{currentPassword:n.currentPassword,newPassword:n.newPassword}}});case 4:e.sent.data.updateUser?(o.b.success("Contrase\xf1a actualizada. Inicie sessi\xf3n nuevamente."),t()):j("La contrase\xf1a no es correcta"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),o.b.error("Error al cambiar la contrase\xf1a");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(P.a,{className:"password-form",onSubmit:d.handleSubmit,children:[Object(a.jsx)(P.a.Input,{placeholder:"Contrase\xf1a actual",type:"password",name:"currentPassword",value:d.values.currentPassword,onChange:d.handleChange,error:d.errors.currentPassword&&!0}),b&&Object(a.jsxs)("p",{className:"submit-error",children:[" ",b," "]}),Object(a.jsx)(P.a.Input,{placeholder:"Nueva contrase\xf1a",type:"password",name:"newPassword",value:d.values.newPassword,onChange:d.handleChange,error:d.errors.newPassword&&!0}),Object(a.jsx)(P.a.Input,{placeholder:"Repetir nueva contrase\xf1a",type:"password",name:"repeatNewPassword",value:d.values.repeatNewPassword,onChange:d.handleChange,error:d.errors.repeatNewPassword&&!0}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Actualizar"})]})}n(295);function ge(e){var t=e.setShowModal,n=e.currentEmail,r=e.refetch,c=Object(u.useMutation)(T),s=Object(i.a)(c,1)[0],l=Object(q.a)({initialValues:{email:n||""},validationSchema:$.a({email:$.c().email().required()}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{input:n}});case 3:a=e.sent,a.data.updateUser?(o.b.success("Email actualizado"),r(),t(!1)):o.b.error("Error al actualizar email"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o.b.error("Error al actualizar email");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(P.a,{className:"email-form",onSubmit:l.handleSubmit,children:[Object(a.jsx)(P.a.Input,{placeholder:"Nuevo email",name:"email",value:l.values.email,onChange:l.handleChange,error:l.errors.email&&!0}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Actualizar"})]})}var we=n(339),Ce=(n(296),n(38));function Se(e){var t=e.setShowModal,n=e.description,r=e.refetch,c=Object(u.useMutation)(T),s=Object(i.a)(c,1)[0],l=Object(q.a)({initialValues:{description:n||""},validationSchema:$.a({description:$.c().required()}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{input:n}});case 3:a=e.sent,a.data.updateUser?(o.b.success("Descripci\xf3n actualizada"),r(),t(!1)):o.b.error("Error al actualizar descripci\xf3n"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o.b.error("Error al actualizar descripci\xf3n");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(P.a,{className:"description-form",onSubmit:l.handleSubmit,children:[Object(a.jsx)(we.a,{name:"description",value:l.values.description,onChange:l.handleChange,className:l.errors.description&&"error"}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Actualizar"})]})}n(298);function Ne(e){var t=e.setShowModal,n=e.siteWeb,r=e.refetch,c=Object(u.useMutation)(T),s=Object(i.a)(c,1)[0],l=Object(q.a)({initialValues:{siteWeb:n||""},validationSchema:$.a({siteWeb:$.c().url().required()}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{input:n}});case 3:a=e.sent,a.data.updateUser?(o.b.success("website actualizado"),r(),t(!1)):o.b.error("Error al actualizar"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o.b.error("Error al actualizar");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(P.a,{className:"website-form",onSubmit:l.handleSubmit,children:[Object(a.jsx)(P.a.Input,{type:"url",placeholder:"website",name:"siteWeb",value:l.values.siteWeb,onChange:l.handleChange,error:l.errors.siteWeb&&!0}),Object(a.jsx)(k.a,{type:"submit",className:"btn-submit",children:"Actualizar"})]})}n(299);function ye(e){var t=e.setShowModal,n=e.setTitleModal,r=e.setChildrenModal,c=e.getUser,s=e.refetch,i=J().logout,o=Object(X.f)(),l=Object(u.useApolloClient)(),b=function(){l.clearStore(),i(),o.push("/")};return Object(a.jsxs)("div",{className:"settings-form",children:[Object(a.jsx)(k.a,{onClick:function(){n("cambiar contrase\xf1a"),r(Object(a.jsx)(xe,{onLogout:b}))},children:"Cambiar contrase\xf1a"}),Object(a.jsx)(k.a,{onClick:function(){n("cambiar email"),r(Object(a.jsx)(ge,{setShowModal:t,currentEmail:c.email,refetch:s}))},children:"Cambiar email"}),Object(a.jsx)(k.a,{onClick:function(){n("Actualizar descripci\xf3n"),r(Object(a.jsx)(Se,{setShowModal:t,description:c.description,refetch:s}))},children:"Descripci\xf3n"}),Object(a.jsx)(k.a,{onClick:function(){n("Actualizar Website"),r(Object(a.jsx)(Ne,{setShowModal:t,siteWeb:c.siteWeb,refetch:s}))},children:"Sitio Web"}),Object(a.jsx)(k.a,{onClick:function(){return b()},children:"Cerrar secci\xf3n"}),Object(a.jsx)(k.a,{onClick:function(){return t(!1)},children:"Cancelar"})]})}n(300);function Pe(e){var t=e.users,n=e.setShowModal,r=Object(X.f)();return Object(a.jsx)("div",{className:"list-users",children:0===Object(Ce.size)(t)?Object(a.jsx)("p",{className:"list-users__not-users",children:"No se han encontrado usuarios"}):Object(Ce.map)(t,(function(e,t){return Object(a.jsxs)("div",{className:"list-users__user",onClick:function(){return t=e.username,n(!1),void r.push("/".concat(t));var t},children:[Object(a.jsx)(C.a,{src:e.avatar||se,avatar:!0}),Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:e.name}),Object(a.jsx)("p",{children:e.username})]})]},t)}))})}n(301);function ke(e){var t=e.username,n=e.totalPublications,c=Object(r.useState)(!1),s=Object(i.a)(c,2),o=s[0],l=s[1],b=Object(r.useState)(""),j=Object(i.a)(b,2),d=j[0],m=j[1],O=Object(r.useState)(null),h=Object(i.a)(O,2),p=h[0],f=h[1],v=Object(u.useQuery)(he,{variables:{username:t}}),x=v.data,g=v.loading,w=v.startPolling,C=v.stopPolling,S=Object(u.useQuery)(pe,{variables:{username:t}}),N=S.data,y=S.loading,P=S.startPolling,k=S.stopPolling;if(Object(r.useEffect)((function(){return w(1e3),function(){return C()}}),[w,C]),Object(r.useEffect)((function(){return P(1e3),function(){return k()}}),[P,k]),g||y)return null;var q=x.getFollowers,$=N.getFolloweds;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"followers",children:[Object(a.jsxs)("p",{children:[" ",Object(a.jsx)("span",{children:n})," publicaciones"]}),Object(a.jsxs)("p",{className:"link",onClick:function(){l(!0),m("Seguidores"),f(Object(a.jsx)(Pe,{users:q,setShowModal:l}))},children:[" ",Object(a.jsx)("span",{children:Object(Ce.size)(q)})," seguidores"]}),Object(a.jsxs)("p",{className:"link",onClick:function(){l(!0),m("seguidos"),f(Object(a.jsx)(Pe,{users:$,setShowModal:l}))},children:[" ",Object(a.jsx)("span",{children:Object(Ce.size)($)})," seguidos"]})]}),Object(a.jsx)(ce,{show:o,setShow:l,title:d,children:p})]})}n(302);function qe(e){var t=e.username,n=e.totalPublications,c=Object(r.useState)(!1),s=Object(i.a)(c,2),o=s[0],l=s[1],b=Object(r.useState)(""),j=Object(i.a)(b,2),d=j[0],m=j[1],O=Object(r.useState)(!1),h=Object(i.a)(O,2),p=h[0],f=h[1],v=J().auth,x=Object(u.useQuery)(W,{variables:{username:t}}),g=x.data,w=x.loading,S=x.error,N=x.refetch;if(w)return null;if(S)return Object(a.jsx)(ae,{});var y=g.getUser,P=function(e){switch(e){case"avatar":m("Cambiar foto de perfil"),f(Object(a.jsx)(te,{setShowModal:l,auth:v})),l(!0);break;case"settings":m("Ajustes"),f(Object(a.jsx)(ye,{setShowModal:l,setTitleModal:m,setChildrenModal:f,getUser:y,refetch:N})),l(!0)}};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(Y.a,{className:"profile",children:[Object(a.jsx)(Y.a.Column,{width:5,className:"profile__left",children:Object(a.jsx)(C.a,{src:y.avatar?y.avatar:se,avatar:!0,onClick:function(){return t===v.username&&P("avatar")}})}),Object(a.jsxs)(Y.a.Column,{width:11,className:"profile__right",children:[Object(a.jsx)(ve,{username:t,auth:v,handleModal:P}),Object(a.jsx)(ke,{username:t,totalPublications:n}),Object(a.jsxs)("div",{className:"other",children:[Object(a.jsx)("p",{className:"name",children:y.name}),y.siteWeb&&Object(a.jsx)("a",{href:y.siteWeb,className:"siteWeb",target:"_blank",children:y.siteWeb}),y.description&&Object(a.jsx)("p",{className:"description",children:y.description})]})]})]}),Object(a.jsx)(ce,{show:o,setShow:l,title:d,children:p})]})}function $e(){var e=Object(F.a)(["\n  query getComments($idPublication: ID!){\n  getComments(idPublication: $idPublication){\n    idPublication\n    idUser{\n      name\n      username\n      avatar\n    }\n    comment\n    createdAt\n  }\n}\n"]);return $e=function(){return e},e}function Fe(){var e=Object(F.a)(["\n  mutation addComment($input: CommentInput) {\n    addComment(input: $input) {\n      idPublication\n      comment\n    }\n  }\n"]);return Fe=function(){return e},e}var Ie=Object(u.gql)(Fe()),Ue=Object(u.gql)($e());n(303);function Me(e){var t=e.publication,n=Object(u.useQuery)(Ue,{variables:{idPublication:t.id}}),c=n.data,s=n.loading,i=n.startPolling,o=n.stopPolling;if(Object(r.useEffect)((function(){return i(1e3),function(){return o()}}),[i,o]),s)return null;var l=c.getComments;return Object(a.jsx)("div",{className:"comments",children:Object(Ce.map)(l,(function(e,t){return Object(a.jsxs)(ne.b,{to:"/".concat(e.idUser.username),className:"comment",children:[Object(a.jsx)(C.a,{src:e.idUser.avatar||se,avatar:!0}),Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:e.idUser.username}),Object(a.jsx)("p",{children:e.comment})]})]},t)}))})}n(304);function _e(e){var t=e.publication,n=Object(u.useMutation)(Ie),r=Object(i.a)(n,1)[0],c=Object(q.a)({initialValues:{comment:""},validationSchema:$.a({comment:$.c().required()}),onSubmit:function(){var e=Object(y.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r({variables:{input:{idPublication:t.id,comment:n.comment}}});case 3:c.handleReset(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()});return Object(a.jsxs)(P.a,{className:"comment-form",onSubmit:c.handleSubmit,children:[Object(a.jsx)(P.a.Input,{placeholder:"A\xf1adir comentario",name:"comment",value:c.values.comment,onChange:c.handleChange,error:c.errors.comment&&!0}),Object(a.jsx)(k.a,{type:"submit",children:"Publicar"})]})}function Ee(){var e=Object(F.a)(["\n  query countLikes($idPublication: ID!) {\n    countLikes(idPublication: $idPublication)\n  }\n"]);return Ee=function(){return e},e}function ze(){var e=Object(F.a)(["\n  query isLike($idPublication: ID!) {\n    isLike(idPublication: $idPublication)\n  }\n"]);return ze=function(){return e},e}function Le(){var e=Object(F.a)(["\n  mutation deleteLike($idPublication: ID!) {\n    deleteLike(idPublication: $idPublication)\n  }\n"]);return Le=function(){return e},e}function Ae(){var e=Object(F.a)(["\n  mutation addLike($idPublication: ID!) {\n    addLike(idPublication: $idPublication)\n  }\n"]);return Ae=function(){return e},e}var Qe=Object(u.gql)(Ae()),We=Object(u.gql)(Le()),De=Object(u.gql)(ze()),Re=Object(u.gql)(Ee()),Te=n(121);n(305);function Ve(e){var t=e.publication,n=Object(r.useState)(!1),c=Object(i.a)(n,2),s=c[0],o=c[1],l=Object(u.useMutation)(Qe),b=Object(i.a)(l,1)[0],j=Object(u.useMutation)(We),d=Object(i.a)(j,1)[0],m=Object(u.useQuery)(De,{variables:{idPublication:t.id}}),O=m.data,h=m.loading,p=m.refetch,f=Object(u.useQuery)(Re,{variables:{idPublication:t.id}}),v=f.data,x=f.loading,g=f.refetch,w=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,b({variables:{idPublication:t.id}});case 4:p(),g(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:o(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,d({variables:{idPublication:t.id}});case 4:p(),g(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:o(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();if(h||x)return null;var S=O.isLike,P=v.countLikes;return Object(a.jsxs)("div",{className:"actions",children:[Object(a.jsx)(Te.a,{className:S?"like active":"like",name:S?"heart":"heart outline",onClick:function(){s||(S?C():w())}}),P," ",1===P?"Like":"Likes"]})}n(306);function Be(e){var t=e.show,n=e.setShow,r=e.publication;return Object(a.jsx)(re.a,{open:t,onClose:function(){return n(!1)},className:"modal-publication",children:Object(a.jsxs)(Y.a,{children:[Object(a.jsx)(Y.a.Column,{className:"modal-publication__left",width:10,style:{backgroundImage:'url("'.concat(r.file,'")')}}),Object(a.jsxs)(Y.a.Column,{className:"modal-publication__right",width:6,children:[Object(a.jsx)(Me,{publication:r}),Object(a.jsx)(Ve,{publication:r}),Object(a.jsx)(_e,{publication:r})]})]})})}n(307);function He(e){var t=e.publication,n=Object(r.useState)(!1),c=Object(i.a)(n,2),s=c[0],u=c[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"preview-publication",onClick:function(){return u(!0)},children:Object(a.jsx)(C.a,{className:"preview-publication__image",src:t.file})}),Object(a.jsx)(Be,{show:s,setShow:u,publication:t})]})}n(308);function Je(e){var t=e.getPublications;return Object(a.jsxs)("div",{className:"publications",children:[Object(a.jsx)("h1",{children:"Publicaciones"}),Object(a.jsx)(Y.a,{columns:4,children:Object(Ce.map)(t,(function(e,t){return Object(a.jsx)(Y.a.Column,{children:Object(a.jsx)(He,{publication:e})},t)}))})]})}function Ke(){var e=Object(F.a)(["\n  query getPublicationsFolloweds {\n    getPublicationsFolloweds {\n      id\n      idUser {\n        name\n        username\n        avatar\n      }\n      file\n      typeFile\n      createdAt\n    }\n  }\n"]);return Ke=function(){return e},e}function Ze(){var e=Object(F.a)(["\n  query getPublications($username: String!) {\n    getPublications(username: $username) {\n      id\n      idUser\n      file\n      typeFile\n    }\n  }\n"]);return Ze=function(){return e},e}function Ge(){var e=Object(F.a)(["\n  mutation publish($file: Upload) {\n    publish(file: $file) {\n      status\n      urlFile\n    }\n  }\n"]);return Ge=function(){return e},e}var Xe=Object(u.gql)(Ge()),Ye=Object(u.gql)(Ze()),et=Object(u.gql)(Ke());n(309);n(310);function tt(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(!1),o=Object(i.a)(s,2),l=o[0],b=o[1],j=Object(u.useQuery)(et),d=j.data,m=j.loading,O=j.startPolling,h=j.stopPolling;if(Object(r.useEffect)((function(){return O(2e3),function(){return h()}}),[O,h]),m)return null;var p=d.getPublicationsFolloweds;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"feed",children:Object(Ce.map)(p,(function(e,t){return Object(a.jsxs)("div",{className:"feed__box",children:[Object(a.jsx)(ne.b,{to:"/".concat(e.idUser.username),children:Object(a.jsxs)("div",{className:"feed__box-user",children:[Object(a.jsx)(C.a,{src:e.idUser.avatar||se,avatar:!0}),Object(a.jsx)("span",{children:e.idUser.name})]})}),Object(a.jsx)("div",{className:"feed__box-photo",style:{backgroundImage:'url("'.concat(e.file,'")')},onClick:function(){return function(e){b(e),c(!0)}(e)}}),Object(a.jsx)("div",{className:"feed__box-actions",children:Object(a.jsx)(Ve,{publication:e})}),Object(a.jsx)("div",{className:"feed__box-form",children:Object(a.jsx)(_e,{publication:e})})]},t)}))}),Object(a.jsx)("div",{children:n&&Object(a.jsx)(Be,{show:n,setShow:c,publication:l})})]})}n(311);function nt(){var e=Object(u.useQuery)(fe),t=e.data;if(e.loading)return null;var n=t.getNotFolloweds;return Object(a.jsxs)("div",{className:"users-not-followeds",children:[Object(a.jsx)("h3",{children:"Usuarios que no sigues"}),Object(Ce.map)(n,(function(e,t){return Object(a.jsxs)(ne.b,{to:"".concat(e.username),className:"users-not-followeds__user",children:[Object(a.jsx)(C.a,{src:e.avatar||se,avatar:!0}),Object(a.jsx)("span",{children:e.username})]},t)}))]})}n(312);var at=n(250),rt=n(345),ct=n(341);n(313);function st(e){var t=e.show,n=e.setShow,c=Object(r.useState)(null),s=Object(i.a)(c,2),b=s[0],j=s[1],d=Object(r.useState)(!1),m=Object(i.a)(d,2),O=m[0],h=m[1],p=Object(u.useMutation)(Xe),f=Object(i.a)(p,1)[0],v=Object(r.useCallback)((function(e){var t=e[0];j({type:"image",file:t,preview:URL.createObjectURL(t)})})),x=Object(ee.a)({accept:"image/jpeg, image/jpg, image/png",noKeyboard:!0,multiple:!1,onDrop:v}),g=x.getRootProps,w=x.getInputProps,C=function(){h(!1),j(null),n(!1)},S=function(){var e=Object(y.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h(!0),e.next=4,f({variables:{file:b.file}});case 4:t=e.sent,t.data.publish.status?C():(o.b.warning("error al publicar"),O(!1)),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(re.a,{size:"small",open:t,onClose:C,className:"modal-upload",children:[Object(a.jsxs)("div",Object(l.a)(Object(l.a)({},g()),{},{className:"dropzone",style:b&&{border:0},children:[!b&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Te.a,{name:"cloud upload"}),Object(a.jsx)("p",{children:"Arrastra tu foto que quieras publicar"})]}),Object(a.jsx)("input",Object(l.a)({},w()))]})),"image"===(null===b||void 0===b?void 0:b.type)&&Object(a.jsx)("div",{className:"image",style:{backgroundImage:'url("'.concat(b.preview,'")')}}),b&&Object(a.jsx)(k.a,{className:"btn-upload btn-action",onClick:S,children:"Publicar"}),O&&Object(a.jsxs)(rt.a,{active:!0,className:"publishing",children:[Object(a.jsx)(ct.a,{}),Object(a.jsx)("p",{children:"Publicando..."})]})]})}n(314);function it(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],s=J().auth,o=Object(u.useQuery)(W,{variables:{username:s.username}}),l=o.data,b=o.loading,j=o.error;if(b||j)return null;var d=l.getUser;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"right-header",children:[Object(a.jsx)(ne.b,{to:"/",children:Object(a.jsx)(Te.a,{name:"home"})}),Object(a.jsx)(Te.a,{name:"plus",onClick:function(){return c(!0)}}),Object(a.jsx)(ne.b,{to:"/".concat(s.username),children:Object(a.jsx)(C.a,{src:d.avatar?d.avatar:se,avatar:!0})})]}),Object(a.jsx)(st,{show:n,setShow:c})]})}var ut=n(343);n(315);function ot(){var e=Object(r.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)([]),o=Object(i.a)(s,2),l=o[0],b=o[1],j=Object(u.useQuery)(V,{variables:{search:n}}),d=j.data,m=j.loading;Object(r.useEffect)((function(){if(Object(Ce.size)(null===d||void 0===d?void 0:d.search)>0){var e=[];d.search.forEach((function(t,n){e.push({key:n,title:t.name,username:t.username,avatar:t.avatar})})),b(e)}else b([])}),[d]);return Object(a.jsx)(ut.a,{className:"search-users",fluid:!0,input:{icon:"search",iconPosition:"left"},loading:m,value:n||"",onSearchChange:function(e){e.target.value?c(e.target.value):c(null)},onResultSelect:function(){c(null),b([])},results:l,resultRenderer:function(e){return Object(a.jsx)(lt,{data:e})}})}function lt(e){var t=e.data;return Object(a.jsxs)(ne.b,{className:"search-users__item",to:"/".concat(t.username),children:[Object(a.jsx)(C.a,{src:t.avatar||se}),Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:t.title}),Object(a.jsx)("p",{children:t.username})]})]})}n(316);function bt(){return Object(a.jsx)("div",{className:"header",children:Object(a.jsx)(w.a,{children:Object(a.jsxs)(Y.a,{children:[Object(a.jsx)(at.a,{width:3,className:"header__logo",children:Object(a.jsx)(ne.b,{to:"/",children:Object(a.jsx)(C.a,{src:Z,alt:"Instaclone"})})}),Object(a.jsx)(at.a,{width:10,children:Object(a.jsx)(ot,{})}),Object(a.jsx)(at.a,{width:3,children:Object(a.jsx)(it,{})})]})})})}function jt(e){var t=e.children;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(bt,{}),Object(a.jsx)(w.a,{className:"layout-basic",children:t})]})}var dt=[{path:"/",layout:jt,component:function(){return J(),Object(a.jsxs)(Y.a,{className:"home",children:[Object(a.jsx)(Y.a.Column,{className:"home__left",width:11,children:Object(a.jsx)(tt,{})}),Object(a.jsx)(Y.a.Column,{className:"home__right",width:5,children:Object(a.jsx)(nt,{})})]})},exact:!0},{path:"/:username",layout:jt,component:function(){var e=Object(X.g)().username,t=Object(u.useQuery)(Ye,{variables:{username:e}}),n=t.data,c=t.loading,s=t.startPolling,i=t.stopPolling;if(Object(r.useEffect)((function(){return s(1e3),function(){i()}}),[s,i]),c)return null;var o=n.getPublications;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(qe,{username:e,totalPublications:Object(Ce.size)(o)}),Object(a.jsx)(Je,{getPublications:o})]})},exact:!0},{layout:jt,component:function(){return Object(a.jsx)("div",{children:Object(a.jsx)("h1",{children:"Error 404..."})})}}];function mt(){return Object(a.jsx)(ne.a,{children:Object(a.jsx)(X.c,{children:Object(Ce.map)(dt,(function(e,t){return Object(a.jsx)(X.a,{path:e.path,exact:e.exact,render:function(t){return Object(a.jsx)(e.layout,{children:Object(a.jsx)(e.component,Object(l.a)({},t))})}},t)}))})})}var Ot=function(){var e=Object(r.useState)(void 0),t=Object(i.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=p();c(e?f(e):null)}),[]);var s=function(){localStorage.removeItem(m),c(null)},l=function(e){c(e)},b=Object(r.useMemo)((function(){return{auth:n,logout:s,setUser:l}}),[n]);return void 0===n?null:Object(a.jsx)(u.ApolloProvider,{client:g,children:Object(a.jsxs)(H.Provider,{value:b,children:[n?Object(a.jsx)(mt,{}):Object(a.jsx)(G,{}),Object(a.jsx)(o.a,{position:"top-right",autoClose:5e3,hideProgressBar:!0,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})},ht=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,348)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};n(317),n(318),n(319);s.a.render(Object(a.jsx)(Ot,{}),document.getElementById("root")),ht()}},[[320,1,2]]]);
//# sourceMappingURL=main.f1816326.chunk.js.map